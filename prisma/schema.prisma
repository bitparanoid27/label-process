generator client {
  provider        = "prisma-client-js"
  output          = "../node_modules/.prisma/client"
  previewFeatures = []
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model FileUpload {
  id         Int      @id @default(autoincrement())
  status     String
  platformId String
  filePath   String
  result     String?
  error      String?
  createdAt  DateTime @default(now())
}

model Platforms {
  id            Int            @id @default(autoincrement())
  platform_name String
  master_orders MasterOrders[]
}

model MasterOrders {
  id                      Int          @id @default(autoincrement())
  buyer_username          String?
  buyer_email             String?
  platform_order_id       String       @unique
  sale_date               DateTime     @db.Date
  recipient_name          String
  recipient_phone_number  String?
  recipient_email_address String?
  recipient_ship_address1 String
  recipient_ship_address2 String?
  recipient_ship_address3 String?
  recipient_city          String
  recipient_state         String
  recipient_country       String
  recipient_post_code     String
  delivery_instructions   String?
  created_at              DateTime     @default(now())
  platform_id             Int
  data_dump               DataDump[]
  platforms               Platforms    @relation(fields: [platform_id], references: [id])
  order_items             OrderItems[]
}

model OrderItems {
  id               Int          @id @default(autoincrement())
  order_item_id    String?
  product_title    String
  product_sku      String
  product_quantity Int
  unit_price       Decimal      @db.Decimal(10, 2)
  master_order_id  Int
  master_order     MasterOrders @relation(fields: [master_order_id], references: [id])
}

model DataDump {
  id                Int          @id @default(autoincrement())
  platform_order_id String
  raw_data          Json
  created_at        DateTime     @default(now())
  master_order_id   Int
  order_id          MasterOrders @relation(fields: [master_order_id], references: [id])
}

model Products {
  id                          Int @id @default(autoincrement())
  sku                         String @unique
  product_name                String

  cost_price                  Decimal ? @db.Decimal(10, 2)
  wholesale_price             Decimal ? @db.Decimal(10, 2)
  projected_price             Decimal ? @db.Decimal(10, 2)
  retail_price                Decimal ? @db.Decimal(10, 2)

  // Dimensions (CM & MM)
  length_cm                   Decimal @db.Decimal(10, 2)
  width_cm                    Decimal @db.Decimal(10, 2)
  height_cm                   Decimal @db.Decimal(10, 2)

  length_mm                   Int
  width_mm                    Int
  height_mm                   Int

  // Weight
  weight_kg                   Decimal @db.Decimal(10, 3)
  weight_gm                   Int

  volume_cm3                  Decimal @db.Decimal(10, 4)

  packaging_strategy          String @default("Standard")
  created_at                  DateTime @default(now())
  updated_at                  DateTime @default(now())
}

model Boxes {
  id                          Int @id @default(autoincrement())
  box_name                    String @unique

  // Dimensions (CM)
  length_cm                   Decimal @db.Decimal(10, 2)
  width_cm                    Decimal @db.Decimal(10, 2)
  height_cm                   Decimal @db.Decimal(10, 2)

  // Dimensions (MM) - ADDED FOR CONSISTENCY
  length_mm                   Int
  width_mm                    Int
  height_mm                   Int

  box_volume_cm3              Decimal @db.Decimal(10, 4)
  box_girth                   Int 
  cost_price                  Decimal @db.Decimal(10, 2)

  created_at                  DateTime @default(now())
  updated_at                  DateTime @default(now())
}

model Couriers {
  id                          Int @id @default(autoincrement())
  courier_name                String
  service_name                String 

  price_24                    Decimal @db.Decimal(10, 2)
  price_48                    Decimal @db.Decimal(10, 2)
  
  // Dimensions (CM)
  length_cm                   Decimal @db.Decimal(10, 2)
  width_cm                    Decimal @db.Decimal(10, 2)
  height_cm                   Decimal @db.Decimal(10, 2)

  // Dimensions (MM)
  length_mm                   Int
  width_mm                    Int
  height_mm                   Int

  max_girth_cm                Int
  max_volume_cm3              Decimal @db.Decimal(15, 4)

  max_weight_kg               Decimal @db.Decimal(10, 3)
  max_weight_gm               Int

  is_active                   Boolean @default(true)

  created_at                  DateTime @default(now())
  updated_at                  DateTime @default(now())

  @@unique([courier_name, service_name])
}